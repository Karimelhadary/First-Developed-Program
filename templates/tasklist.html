<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Task List â€” Task Management System</title>

  <link
    href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css"
    rel="stylesheet"
  />
  <link rel="stylesheet" href="{{ url_for('static', filename='tasklist.css') }}" />
</head>
<body>

<nav class="navbar navbar-expand-lg navbar-light bg-light mb-3">
  <div class="container-fluid">
    <a class="navbar-brand" href="{{ url_for('splash_bp.splash') }}">TaskManager</a>
    <div class="collapse navbar-collapse">
      <ul class="navbar-nav me-auto">
        <li class="nav-item"><a class="nav-link" href="{{ url_for('dashboard_bp.dashboard') }}">Dashboard</a></li>
        <li class="nav-item"><a class="nav-link active" href="{{ url_for('tasks_bp.task_list') }}">Tasks</a></li>
      </ul>
    </div>
  </div>
</nav>

<header class="container mb-3">
  <a href="{{ url_for('dashboard_bp.dashboard') }}" class="back">â† Dashboard</a>
  <h2>All Tasks</h2>
</header>

<main class="container">
  <div class="filters mb-3">
    <form method="get" class="d-flex align-items-center gap-2">
      <label class="form-label mb-0">Sort by:</label>
      <select class="form-select w-auto" name="sort" onchange="this.form.submit()">
        <option value="due_date" {% if sort == 'due_date' %}selected{% endif %}>Due Date</option>
        <option value="importance" {% if sort == 'importance' %}selected{% endif %}>Importance</option>
        <option value="complexity" {% if sort == 'complexity' %}selected{% endif %}>Complexity</option>
      </select>
    </form>
  </div>

  <ul class="task-list list-unstyled">
    {% for t in tasks %}
    <li class="d-flex justify-content-between align-items-center p-2 mb-2 border rounded {% if t.completed %}completed{% endif %}">
      <div class="info">
        <h5 class="mb-1">{{ t.title }}</h5>
        <p class="mb-0">Due: {{ t.due_date }}</p>
        <p class="mb-0">Importance: {{ t.importance }} | Complexity: {{ t.complexity }}</p>
      </div>
      <div class="actions d-flex align-items-center gap-2">
        <form action="{{ url_for('tasks_bp.toggle_complete', task_id=t.id, sort=sort) }}" method="post">
          <button class="btn btn-sm {% if t.completed %}btn-outline-secondary{% else %}btn-success{% endif %}" type="submit">
            {% if t.completed %}â†©ï¸ Undo{% else %}âœ… Done{% endif %}
          </button>
        </form>

        <a href="{{ url_for('tasks_bp.edit_task', task_id=t.id) }}" class="btn btn-sm btn-outline-primary">âœï¸</a>

        <form action="{{ url_for('tasks_bp.delete_task', task_id=t.id) }}" method="post">
          <button class="btn btn-sm btn-danger" type="submit">ğŸ—‘ï¸</button>
        </form>
      </div>
    </li>
    {% else %}
    <li>No tasks yet. Add one!</li>
    {% endfor %}
  </ul>

  <a href="{{ url_for('tasks_bp.add_task') }}" class="btn btn-primary mt-3">+ Add Task</a>
</main>

<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"></script>
</body>
</html>