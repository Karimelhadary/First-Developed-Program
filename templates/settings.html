{% extends "base.html" %}
{% set active='settings' %}
{% block title %}TaskManager â€” Settings{% endblock %}
{% block content %}
<div class="tm-form-card">
  <div class="d-flex justify-content-between align-items-end flex-wrap gap-2 mb-3">
    <div>
      <h1 class="tm-page-title h3 mb-1">Settings</h1>
      <div class="tm-subtitle">Customize your timer and appearance.</div>
    </div>
  </div>

  <div class="tm-card card p-4">
    <form method="post">
      <div class="row g-3">
        <div class="col-12">
          <div class="d-flex justify-content-between align-items-center">
            <div>
              <div class="fw-semibold">Theme</div>
              <div class="small opacity-75">Switch between light and dark mode.</div>
            </div>
            <div class="form-check form-switch">
              <input class="form-check-input" type="checkbox" role="switch" id="themeToggle" {% if settings.theme=='dark' %}checked{% endif %}>
              <label class="form-check-label small" for="themeToggle">Dark mode</label>
            </div>
          </div>
          <input type="hidden" name="theme" id="themeHidden" value="{{ settings.theme }}"/>
        </div>

        <div class="col-12"><hr/></div>

        <div class="col-12">
          <div class="fw-semibold mb-1">Pomodoro defaults</div>
          <div class="small opacity-75">Used as defaults on the Timer page (you can still change per session).</div>
        </div>

        <div class="col-12 col-md-3">
          <label class="form-label">Focus minutes</label>
          <input class="form-control" type="number" name="focus_minutes" min="1" max="180" value="{{ settings.focus_minutes }}" required>
        </div>

        <div class="col-12 col-md-3">
          <label class="form-label">Break minutes</label>
          <input class="form-control" type="number" name="break_minutes" min="1" max="60" value="{{ settings.break_minutes }}" required>
        </div>

        <div class="col-12 col-md-3">
          <label class="form-label">Long break minutes</label>
          <input class="form-control" type="number" name="long_break_minutes" min="1" max="90" value="{{ settings.long_break_minutes }}" required>
        </div>

        <div class="col-12 col-md-3">
          <label class="form-label">Sessions before long break</label>
          <input class="form-control" type="number" name="sessions_before_long_break" min="1" max="12" value="{{ settings.sessions_before_long_break }}" required>
        </div>
      </div>

      <div class="d-flex justify-content-end mt-4">
        <button class="btn btn-primary tm-primary-btn" type="submit">Save settings</button>
      </div>
    </form>
  </div>
</div>
{% endblock %}

{% block scripts %}
<script>
  const toggle = document.getElementById('themeToggle');
  const hidden = document.getElementById('themeHidden');
  if(toggle && hidden){
    const sync = () => hidden.value = toggle.checked ? 'dark' : 'light';
    toggle.addEventListener('change', sync);
    sync();
  }
</script>
{% endblock %}
