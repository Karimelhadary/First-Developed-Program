{% extends "base.html" %}
{% set active='dashboard' %}
{% block title %}TaskManager â€” Dashboard{% endblock %}
{% block content %}
<div class="d-flex flex-wrap justify-content-between align-items-end gap-2 mb-3">
  <div>
    <h1 class="tm-page-title h3 mb-1">Hello{% if user_name %}, {{ user_name }}{% endif %}!</h1>
    <div class="tm-subtitle">Mood today: <span class="tm-chip">{{ mood_label }}</span></div>
  </div>

  <div class="d-flex gap-2">
    <a class="btn btn-primary tm-primary-btn" href="{{ url_for('timer_break_bp.timer_page') }}">â±ï¸ Start Focus Session</a>
    <a class="btn btn-outline-primary tm-primary-btn" href="{{ url_for('tasks_bp.add_task') }}">ï¼‹ Add Task</a>
  </div>
</div>

<div class="row g-3">
  <div class="col-12 col-lg-7">
    <div class="tm-card card p-4">
      <div class="d-flex justify-content-between align-items-center mb-3">
        <h2 class="h5 mb-0">Your tasks for today</h2>

        <!-- UPDATED: View all now looks like a proper button -->
        <a href="{{ url_for('tasks_bp.task_list') }}"
           class="btn btn-sm btn-outline-primary tm-pill-btn">
          View all <span class="ms-1">â†’</span>
        </a>
      </div>

      {% if tasks and tasks|length > 0 %}
        <div class="list-group">
          {% for t in tasks %}
            <div class="list-group-item d-flex justify-content-between align-items-start gap-3">
              <div class="me-auto">
                <div class="fw-semibold">{{ t.title }}</div>
                <div class="small opacity-75">
                  {% if t.due_date %}Due: {{ t.due_date }} Â· {% endif %}
                  Importance: {{ t.importance }} Â· Complexity: {{ t.complexity }}
                </div>
                {% if t.tags and t.tags|length > 0 %}
                  <div class="mt-2">
                    {% for tag in t.tags[:4] %}
                      <span class="tm-chip">{{ tag }}</span>
                    {% endfor %}
                  </div>
                {% endif %}
              </div>
              <span class="badge rounded-pill text-bg-{{ 'success' if t.completed else 'secondary' }}">
                {{ 'Done' if t.completed else 'Open' }}
              </span>
            </div>
          {% endfor %}
        </div>
      {% else %}
        <div class="text-center py-4">
          <div class="fs-1">âœ…</div>
          <div class="fw-semibold">No tasks yet</div>
          <div class="tm-subtitle mb-3">Create your first task to get started.</div>
          <a class="btn btn-primary tm-primary-btn" href="{{ url_for('tasks_bp.add_task') }}">Add your first task</a>
        </div>
      {% endif %}
    </div>
  </div>

  <div class="col-12 col-lg-5">
    <div class="tm-card card p-4">
      <h2 class="h5 mb-3">Quick actions</h2>

      <div class="d-grid gap-2">
        <a class="btn btn-outline-primary tm-primary-btn" href="{{ url_for('insights_bp.insights') }}">ğŸ“Š Insights</a>
        <a class="btn btn-outline-primary tm-primary-btn" href="{{ url_for('projects_bp.projects_list') }}">ğŸ“ Projects</a>
        <a class="btn btn-outline-primary tm-primary-btn" href="{{ url_for('settings_bp.settings_page') }}">âš™ï¸ Settings</a>
      </div>
      <div class="tm-subtitle small mt-3">
        Tip: start a focus session and your progress will appear in Insights automatically.
      </div>
    </div>
  </div>
</div>
{% endblock %}
